<section class="row section-field">

  <h5 class="center"> {{titulo}} </h5>

  <br>
  <div class="row col m4 ">
    <section>
      <nav style="height: 35px; display: flex; align-items: center; background-color: #f5f5f5; box-shadow: none;">
        <ul>
          <li style="margin-left: 15px; text-transform: lowercase;">Dados do paciente</li>
        </ul>
      </nav>

      <div class="white row">
        <img src="{{URL}}/Files/Imagem/paciente/{{imagem}}" style="margin-left: 5px;" class="materialboxed col m2 "
          width="50" height="90">
        <span class="col m9"><strong>Nome:</strong> {{nome}}</span>
        <span class="col m3"><strong>Idade:</strong> {{11}}</span>
        <span class="col m5"><strong>Genero:</strong> {{genero}}</span>
        <span class="col m5"><strong>Telefone:</strong> {{telefone1}}</span>
        <span class="col m9"><strong>E-mail:</strong> {{email}}</span>
        <span class="col m9" style="margin-left: 20px;"><strong>Morada:</strong> {{morada}}</span>
      </div>
    </section>

    <section>
      <nav style="height: 35px; display: flex; align-items: center; background-color: #f5f5f5; box-shadow: none;">
        <ul>
          <li style="margin-left: 15px; text-transform: lowercase;">Dados da triagem</li>
        </ul>
      </nav>
      <div class="white row">

        <span class="col m9" style="margin-left: 20px;"><strong>Peso:</strong> {{morada}}</span>
        <span class="col m9" style="margin-left: 20px;"><strong>Temperatura Corporal:</strong> {{morada}}</span>
        <span class="col m9" style="margin-left: 20px;"><strong>Satura√ß√£o de Oxig√™nio:</strong> {{morada}}</span>
        <span class="col m9" style="margin-left: 20px;"><strong>Press√£o Arterial:</strong> {{morada}}</span>
        <span class="col m9" style="margin-left: 20px;"><strong>Frequ√™ncia Respirat√≥ria:</strong> {{morada}}</span>
        <span class="col m9" style="margin-left: 20px;"><strong><br></span>
        <span class="col m9" style="margin-left: 20px;"><strong>Observa√ß√£o:</strong> {{morada}}</span>

      </div>
    </section>


  </div>

  <div class=" row offset-m1 col m7 s12">
    <div class="col s12 blue-grey darken-1 row">
      <!--header das abas-->
      <ul class="tabs tabsvendedor blue-grey darken-1 " style="height: 35px; display: flex; align-items: center; justify-self: start; background-color: #f5f5f5; box-shadow: none;">
        <li class="tab"><a class="active font-normal" href="#consultaDados">Consulta</a></li>
        <li class="tab"><a class="font-normal" href="#exameDados">Exames</a></li>
      </ul>
    </div>

    <!-- formulario para resgistar consulta -->
    <form class="" method="post" enctype="multipart/form-data">

      <!--aba consulta-->
      <section id="consultaDados" class="col m12 s12">
        <div class="row col m12">
          <br>
          <div class="input-field col s12 m12">
            <input id="motivo" type="text" name="motivo" value="{{motivo}}" class="validate">
            <label for="motivo" style="text-transform: capitalize;">Motivo da consulta:</label>
          </div>

          <div class="input-field col s12 m12">
            <input id="Observa√ß√£o" type="text" name="obs" value="{{obs}}" class="validate">
            <label for="Observa√ß√£o" style="text-transform: capitalize;">Observa√ß√£o:</label>
          </div>

          <div class="input-field col s12 m12">
            <input id="Diagn√≥stico" type="text" name="diagnostico" value="{{diagnostico}}" class="validate">
            <label for="Diagn√≥stico" style="text-transform: capitalize;">Diagn√≥stico:</label>
          </div>
        </div>

      </section>

      <!--Aba exame-->
      <section id="exameDados" class="col m12 s12">
        <div class="col m12">
          <br>
          <table class="responsive-table">
            <thead>
              <tr >
                <th class="grey lighten-1 font-normal" style="border-right: 2px solid #fcfcfc;">Tipo</th>
                <th class="grey lighten-1 font-normal" style="border-right: 2px solid #fcfcfc;">Nome</th>
                <th class="grey lighten-1 font-normal" style="border-right: 2px solid #fcfcfc;">Paramentro</th>
                <th class="grey lighten-1 font-normal" style="border-right: 2px solid #fcfcfc;">Nivel de Urgencia</th>
                <th class=" grey lighten-1 font-normal" style="border-right: 2px solid #fcfcfc;">A√ß√£o</th>
              </tr>
            </thead>
            <tbody id="tabela-body">
              <tr >
                <td class="">
                  <select name="examesTipo[]" id="">
                    <option value="" disabled selected>seleciona</option>
                    <option value="Imagem">Imagem</option>
                    <option value="Imunologia">Imunologia</option>
                    <option value="Bioqu√≠mica">Bioqu√≠mica</option>
                  </select>
                </td>
                <td>
                  <select name="examesNome[]">
                    <option value="" disabled selected>seleciona</option>
                    {{exames}}
                  </select>
                </td>
                <td><input type="text" name="exameParametro[]" class="validate" equired></td>
                <td><input type="text" name="exameUrgencia[]" class="validate" equired></td>
                <td class="center">
                  <a class="tooltip-container btn red white-text" onclick="removerLinha(this)">
                    <i class="material-icons center">delete</i>
                    <div class="custom-tooltip font-normal ">Remover linha de exame</div>
                  </a>
                </td>
              </tr>
            </tbody>
          </table>

          <div class="row center ">
            <br>
            <a class="tooltip-container btn blue" onclick="adicionarLinha()">
              <i class="material-icons center">add</i>
              <div class="custom-tooltip font-normal ">Adicionar linha de exame</div>
            </a>
          </div>
        </div>

      </section>

      <div class="div-input push-m9 col s12 m2 row ">
        <button class=" col m12 btn  white-text  font-normal" name="salvar" type="submit">{{button}}</button>
      </div>

    </form>

  </div>
</section>


<script src="{{URL}}/Assets/js/main.js"></script>

<script>
  function adicionarLinha12() {
    const tabela = document.getElementById('tabela-body');
    const novaLinha = tabela.rows[0].cloneNode(true);

    // Limpar SELECTS
    const select = novaLinha.querySelectorAll('select');
    selects.forEach(select => {
      select.value = '';
      select.removeAttribute('id'); // remove ID duplicado
    });

    // Limpar INPUTS (se houver)
    const input = novaLinha.querySelectorAll('input');
    inputs.forEach(input => {
      input.value = '';
      input.removeAttribute('id');
    });

    const inputs = novaLinha.querySelectorAll('input,select');
    inputs.forEach(input => input.value = '');
    tabela.appendChild(novaLinha);
  }

  function adicionarLinha15() {
    const tabela = document.getElementById('tabela-body');

    // Clonar a primeira linha
    const novaLinha = tabela.rows[0].cloneNode(true);

    // REMOVER elementos criados pelo MATERIALIZE
    //novaLinha.querySelectorAll('.select-wrapper').forEach(wrapper => wrapper.remove());

    // üîÑ Restaurar os <select> originais (s√≥ o elemento select)
    const selectsOriginais = tabela.rows[0].querySelectorAll('select');
    const selectsNovos = novaLinha.querySelectorAll('select');

    selectsNovos.forEach((select, index) => {
      select.innerHTML = selectsOriginais[index].innerHTML; // rep√µe options
      select.value = ''; // limpa sele√ß√£o
      select.removeAttribute('id'); // remove ID duplicado
      select.classList.remove('initialized'); // muito importante
    });

    // Limpar inputs
    novaLinha.querySelectorAll('input').forEach(input => {
      input.value = '';
      input.removeAttribute('id');
    });


    tabela.appendChild(novaLinha);

    // üîÑ Reinicializar Materialize corretamente
    setTimeout(() => {
      M.FormSelect.init(document.querySelectorAll('select'));
    }, 0);
  }

  function adicionarLinha00() {
    const tabela = document.getElementById('tabela-body');

    // Clonar a primeira linha
    const novaLinha = tabela.rows[0].cloneNode(true);

    // Limpar SELECTS
    const selects = novaLinha.querySelectorAll('select');
    selects.forEach(select => {
      select.value = '';
      select.removeAttribute('id'); // remove ID duplicado
    });

    // Limpar INPUTS (se houver)
    const inputs = novaLinha.querySelectorAll('input');
    inputs.forEach(input => {
      input.value = '';
      input.removeAttribute('id');
    });

    // Adicionar a nova linha √† tabela
    tabela.appendChild(novaLinha);

    // Reinicializar SELECTS do Materialize
    setTimeout(() => {
      M.FormSelect.init(document.querySelectorAll('select'));
    }, 10);
  }

  function adicionarLinha() {
    const tabela = document.getElementById('tabela-body');
    const linhaModelo = tabela.rows[0];
    const novaLinha = linhaModelo.cloneNode(true);

    // Substituir select-wrapper por selects novos
    const wrappersClonados = Array.from(novaLinha.querySelectorAll('.select-wrapper'));
    const selectsModelo = Array.from(linhaModelo.querySelectorAll('select'));

    wrappersClonados.forEach((wrapper, idx) => {
      const selectModelo = selectsModelo[idx];
      if (!selectModelo) {
        wrapper.remove();
        return;
      }

      const novoSelect = document.createElement('select');
      novoSelect.innerHTML = selectModelo.innerHTML;

      Array.from(selectModelo.attributes).forEach(attr => {
        if (attr.name.toLowerCase() !== 'id') {
          novoSelect.setAttribute(attr.name, attr.value);
        }
      });

      novoSelect.value = '';
      novoSelect.removeAttribute('id');

      wrapper.parentNode.replaceChild(novoSelect, wrapper);
    });

    // Limpar selects simples
    novaLinha.querySelectorAll('select').forEach(select => {
      select.value = '';
      select.classList.remove('initialized');
      select.removeAttribute('id');
    });

    // Limpar inputs e remover IDs
    novaLinha.querySelectorAll('input, textarea').forEach(el => {
      if (el.type === 'checkbox' || el.type === 'radio') {
        el.checked = false;
      } else {
        el.value = '';
      }
      el.removeAttribute('id');
    });

    tabela.appendChild(novaLinha);

    // Reinicializar Materialize
    setTimeout(() => {
      M.FormSelect.init(document.querySelectorAll('select'));
    }, 0);
  }

  function removerLinhaz(botao) {
    const linha = botao.closest('tr');
    const tabela = document.getElementById('tabela-body');
    if (tabela.rows.length > 1) linha.remove();
  }

  function adicionarLinha1() {
    const tabela = document.getElementById('tabela-body1');
    const novaLinha = tabela.rows[0].cloneNode(true);

    const inputs = novaLinha.querySelectorAll('input,select');
    inputs.forEach(input => input.value = '');
    tabela.appendChild(novaLinha);
  }

  function removerLinha(botao) {
    const linha = botao.closest('tr');
    const tabela = document.getElementById('tabela-body');
    if (tabela.rows.length > 1) {
      linha.remove();
    } else {
      M.toast({ html: 'A tabela deve conter pelo menos uma linha.', classes: 'red' });
    }
  }
  function removerLinha1(botao) {
    const linha = botao.closest('tr');
    const tabela = document.getElementById('tabela-body1');
    if (tabela.rows.length > 1) {
      linha.remove();
    } else {
      M.toast({ html: 'A tabela deve conter pelo menos uma linha.', classes: 'red' });
    }
  }
</script>
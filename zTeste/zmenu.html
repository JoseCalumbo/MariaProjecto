<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ribbon tipo Word com Materialize</title>
  <!-- Materialize CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" />
  <!-- Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    /* ===== Ribbon layout ===== */
    .ribbon {
      background: #fafafa;
      border-bottom: 1px solid #e0e0e0;
    }
    .ribbon .tabs {
      margin: 0;
      padding-left: 8px;
      background: #fff;
      border-bottom: 1px solid #e0e0e0;
    }
    .ribbon .tab a {
      color: #424242;
      font-weight: 600;
      text-transform: none;
    }
    .ribbon .tab a.active {
      color: #1e88e5;
      border-bottom: 2px solid #1e88e5 !important;
    }
    .ribbon-content {
      padding: 8px 12px 4px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      grid-gap: 10px;
      align-items: start;
      background: #fafafa;
    }
    .group {
      background: #fff;
      border: 1px solid #e0e0e0;
      border-radius: 12px;
      padding: 8px 8px 24px;
      position: relative;
      min-height: 84px;
    }
    .group-title {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      bottom: 4px;
      font-size: 0.78rem;
      color: #757575;
      text-transform: uppercase;
      letter-spacing: .05em;
      background: #fff;
      padding: 0 6px;
    }
    .toolbar-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: center;
    }
    .btn-flat.icon {
      height: 36px;
      line-height: 36px;
      padding: 0 8px;
      border-radius: 8px;
    }
    .btn-flat.icon .material-icons { vertical-align: middle; }

    /* Toggle-like buttons */
    .toggle-btn.active {
      background: #e3f2fd;
      border-radius: 8px;
    }

    /* Tiny inputs for font/size */
    .mini-input {
      max-width: 80px;
      height: 32px;
      margin: 0;
    }
    .divider-v {
      width: 1px; align-self: stretch; background:#eeeeee; margin: 0 4px;
    }
    .doc-title {
      display:flex; align-items:center; gap:8px; padding:4px 12px; border-bottom:1px solid #eee; background:#fff;
    }
    .doc-title input { border: none; box-shadow: none; }
  </style>
</head>
<body class="grey lighten-5">

  <!-- App bar -->
  <nav class="white z-depth-0" style="border-bottom:1px solid #eee">
    <div class="nav-wrapper container" style="max-width: 1200px;">
      <a href="#" class="brand-logo black-text" style="font-size: 1.1rem;">
        <i class="material-icons">description</i> Documento sem nome
      </a>
      <ul class="right">
        <li><a class="black-text dropdown-trigger" href="#" data-target="fileMenu"><i class="material-icons left">folder_open</i>Ficheiro</a></li>
        <li><a class="black-text dropdown-trigger" href="#" data-target="shareMenu"><i class="material-icons left">share</i>Partilhar</a></li>
        <li><a class="btn waves-effect" href="#"><i class="material-icons left">cloud_upload</i>Guardar</a></li>
      </ul>
    </div>
  </nav>

  <!-- Dropdowns -->
  <ul id="fileMenu" class="dropdown-content">
    <li><a href="#!"><i class="material-icons left">note_add</i>Novo</a></li>
    <li><a href="#!"><i class="material-icons left">folder_open</i>Abrir</a></li>
    <li class="divider" tabindex="-1"></li>
    <li><a href="#!"><i class="material-icons left">save</i>Guardar</a></li>
    <li><a href="#!"><i class="material-icons left">picture_as_pdf</i>Exportar PDF</a></li>
  </ul>
  <ul id="shareMenu" class="dropdown-content">
    <li><a href="#!"><i class="material-icons left">person_add</i>Convidar</a></li>
    <li><a href="#!"><i class="material-icons left">link</i>Copiar link</a></li>
  </ul>

  <!-- Tabs (Ribbon header) -->
  <div class="ribbon">
    <div class="container" style="max-width: 1200px;">
      <ul id="ribbonTabs" class="tabs tabs-fixed-width">
        <li class="tab"><a class="active" href="#tab-home">Base</a></li>
        <li class="tab"><a href="#tab-insert">Inserir</a></li>
        <li class="tab"><a href="#tab-layout">Layout</a></li>
        <li class="tab"><a href="#tab-review">Rever</a></li>
        <li class="tab"><a href="#tab-view">Vista</a></li>
      </ul>
    </div>

    <!-- Ribbon Content: HOME -->
    <div id="tab-home" class="container ribbon-content" style="max-width: 1200px;">
      <!-- Clipboard -->
      <div class="group">
        <div class="toolbar-row" style="margin-bottom:6px;">
          <a class="btn waves-effect"><i class="material-icons left">content_paste</i>Colar</a>
          <div class="divider-v"></div>
          <a class="btn-flat icon tooltipped" data-tooltip="Copiar"><i class="material-icons">content_copy</i></a>
          <a class="btn-flat icon tooltipped" data-tooltip="Cortar"><i class="material-icons">content_cut</i></a>
          <a class="btn-flat icon tooltipped" data-tooltip="Pincel de Formatação"><i class="material-icons">format_paint</i></a>
        </div>
        <span class="group-title">Área de Transferência</span>
      </div>

      <!-- Font -->
      <div class="group">
        <div class="toolbar-row" style="margin-bottom:6px;">
          <input id="fontName" class="browser-default mini-input" list="fonts" placeholder="Fonte" />
          <datalist id="fonts">
            <option>Arial</option><option>Calibri</option><option>Times New Roman</option><option>Roboto</option>
          </datalist>
          <input id="fontSize" type="number" class="browser-default mini-input" min="8" max="72" value="11" />
          <div class="divider-v"></div>
          <a class="btn-flat icon toggle-btn" data-cmd="bold"><i class="material-icons">format_bold</i></a>
          <a class="btn-flat icon toggle-btn" data-cmd="italic"><i class="material-icons">format_italic</i></a>
          <a class="btn-flat icon toggle-btn" data-cmd="underline"><i class="material-icons">format_underlined</i></a>
          <a class="btn-flat icon" data-cmd="format_clear"><i class="material-icons">format_clear</i></a>
        </div>
        <div class="toolbar-row">
          <a class="btn-flat icon" data-cmd="format_color_text"><i class="material-icons">format_color_text</i></a>
          <a class="btn-flat icon" data-cmd="format_color_fill"><i class="material-icons">format_color_fill</i></a>
          <a class="btn-flat icon" data-cmd="superscript"><i class="material-icons">superscript</i></a>
          <a class="btn-flat icon" data-cmd="subscript"><i class="material-icons">subscript</i></a>
        </div>
        <span class="group-title">Tipo de Letra</span>
      </div>

      <!-- Paragraph -->
      <div class="group">
        <div class="toolbar-row" style="margin-bottom:6px;">
          <a class="btn-flat icon" data-cmd="format_align_left"><i class="material-icons">format_align_left</i></a>
          <a class="btn-flat icon" data-cmd="format_align_center"><i class="material-icons">format_align_center</i></a>
          <a class="btn-flat icon" data-cmd="format_align_right"><i class="material-icons">format_align_right</i></a>
          <a class="btn-flat icon" data-cmd="format_align_justify"><i class="material-icons">format_align_justify</i></a>
          <div class="divider-v"></div>
          <a class="btn-flat icon" data-cmd="format_list_bulleted"><i class="material-icons">format_list_bulleted</i></a>
          <a class="btn-flat icon" data-cmd="format_list_numbered"><i class="material-icons">format_list_numbered</i></a>
          <a class="btn-flat icon" data-cmd="format_indent_increase"><i class="material-icons">format_indent_increase</i></a>
          <a class="btn-flat icon" data-cmd="format_indent_decrease"><i class="material-icons">format_indent_decrease</i></a>
        </div>
        <div class="toolbar-row">
          <a class="btn-flat icon" data-cmd="space_before"><i class="material-icons">vertical_align_top</i></a>
          <a class="btn-flat icon" data-cmd="space_after"><i class="material-icons">vertical_align_bottom</i></a>
          <a class="btn-flat icon" data-cmd="border_all"><i class="material-icons">border_all</i></a>
          <a class="btn-flat icon" data-cmd="clear_all"><i class="material-icons">clear_all</i></a>
        </div>
        <span class="group-title">Parágrafo</span>
      </div>

      <!-- Styles -->
      <div class="group">
        <div class="toolbar-row" style="margin-bottom:6px;">
          <a class="btn-flat icon" data-style="Normal">Normal</a>
          <a class="btn-flat icon" data-style="Heading 1">Título 1</a>
          <a class="btn-flat icon" data-style="Heading 2">Título 2</a>
        </div>
        <div class="toolbar-row">
          <a class="btn-flat icon dropdown-trigger" data-target="stylesMenu">Mais estilos<i class="material-icons right">arrow_drop_down</i></a>
        </div>
        <span class="group-title">Estilos</span>
      </div>
      <ul id="stylesMenu" class="dropdown-content">
        <li><a href="#!">Citação</a></li>
        <li><a href="#!">Ênfase</a></li>
        <li><a href="#!">Código</a></li>
      </ul>
    </div>

    <!-- Ribbon Content: INSERT -->
    <div id="tab-insert" class="container ribbon-content" style="max-width: 1200px;">
      <div class="group">
        <div class="toolbar-row">
          <a class="btn-flat icon"><i class="material-icons">image</i> Imagem</a>
          <a class="btn-flat icon"><i class="material-icons">table_chart</i> Tabela</a>
          <a class="btn-flat icon"><i class="material-icons">insert_chart</i> Gráfico</a>
          <a class="btn-flat icon"><i class="material-icons">title</i> Campo de Texto</a>
        </div>
        <span class="group-title">Elementos</span>
      </div>
      <div class="group">
        <div class="toolbar-row">
          <a class="btn-flat icon"><i class="material-icons">functions</i> Símbolo</a>
          <a class="btn-flat icon"><i class="material-icons">horizontal_rule</i> Linha</a>
        </div>
        <span class="group-title">Outros</span>
      </div>
    </div>

    <!-- Ribbon Content: LAYOUT -->
    <div id="tab-layout" class="container ribbon-content" style="max-width: 1200px;">
      <div class="group">
        <div class="toolbar-row">
          <a class="btn-flat icon"><i class="material-icons">view_column</i> Margens</a>
          <a class="btn-flat icon"><i class="material-icons">pages</i> Orientação</a>
          <a class="btn-flat icon"><i class="material-icons">format_size</i> Tamanho</a>
        </div>
        <span class="group-title">Página</span>
      </div>
      <div class="group">
        <div class="toolbar-row">
          <a class="btn-flat icon"><i class="material-icons">format_line_spacing</i> Espaçamento</a>
          <a class="btn-flat icon"><i class="material-icons">view_stream</i> Colunas</a>
        </div>
        <span class="group-title">Parágrafo</span>
      </div>
    </div>

    <!-- Ribbon Content: REVIEW -->
    <div id="tab-review" class="container ribbon-content" style="max-width: 1200px;">
      <div class="group">
        <div class="toolbar-row">
          <a class="btn-flat icon"><i class="material-icons">spellcheck</i> Ortografia</a>
          <a class="btn-flat icon"><i class="material-icons">rate_review</i> Comentário</a>
          <a class="btn-flat icon"><i class="material-icons">compare_arrows</i> Controlar Alterações</a>
        </div>
        <span class="group-title">Revisão</span>
      </div>
    </div>

    <!-- Ribbon Content: VIEW -->
    <div id="tab-view" class="container ribbon-content" style="max-width: 1200px;">
      <div class="group">
        <div class="toolbar-row">
          <a class="btn-flat icon toggle-btn"><i class="material-icons">grid_on</i> Mostrar grelha</a>
          <a class="btn-flat icon toggle-btn"><i class="material-icons">straighten</i> Réguas</a>
          <a class="btn-flat icon toggle-btn"><i class="material-icons">zoom_in</i> Zoom +</a>
          <a class="btn-flat icon toggle-btn"><i class="material-icons">zoom_out</i> Zoom −</a>
        </div>
        <span class="group-title">Exibição</span>
      </div>
    </div>
  </div>

  <!-- Documento (editor simulado) -->
  <div class="container" style="max-width: 900px;">
    <div class="doc-title">
      <i class="material-icons">description</i>
      <input id="docName" type="text" class="validate" placeholder="Documento sem nome" />
    </div>
    <div id="editor" contenteditable="true" class="white z-depth-1" style="min-height: 380px; padding: 18px; border-radius: 12px;">
      <h5>Experimente o "ribbon" tipo Word feito com Materialize</h5>
      <p>Selecione algum texto e use os botões acima (negrito, itálico, alinhamentos, listas, etc.).</p>
    </div>
  </div>

  <!-- Materialize JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script>
    // Inicialização (Materialize 1.0.0)
    document.addEventListener('DOMContentLoaded', function() {
      var elemsTabs = document.querySelectorAll('.tabs');
      M.Tabs.init(elemsTabs, { swipeable: false });
      var elemsDrop = document.querySelectorAll('.dropdown-trigger');
      M.Dropdown.init(elemsDrop, { constrainWidth: false, coverTrigger: false });
      var elemsTips = document.querySelectorAll('.tooltipped');
      M.Tooltip.init(elemsTips);
    });

    // Execução simples de comandos no editor
    const editor = document.getElementById('editor');

    function exec(command, value = null) {
      editor.focus();
      document.execCommand(command, false, value);
    }

    // Toggle visual para botões tipo on/off
    function toggleActive(btn) {
      btn.classList.toggle('active');
    }

    // Listeners dos botões com data-cmd
    document.addEventListener('click', function(e) {
      const btn = e.target.closest('[data-cmd]');
      if (!btn) return;
      const cmd = btn.getAttribute('data-cmd');
      if (['bold','italic','underline','justifyCenter','justifyLeft','justifyRight'].includes(cmd)) {
        toggleActive(btn);
      }
      switch(cmd){
        case 'bold': exec('bold'); break;
        case 'italic': exec('italic'); break;
        case 'underline': exec('underline'); break;
        case 'format_clear': exec('removeFormat'); break;
        case 'format_align_left': exec('justifyLeft'); break;
        case 'format_align_center': exec('justifyCenter'); break;
        case 'format_align_right': exec('justifyRight'); break;
        case 'format_align_justify': exec('justifyFull'); break;
        case 'format_list_bulleted': exec('insertUnorderedList'); break;
        case 'format_list_numbered': exec('insertOrderedList'); break;
        case 'format_indent_increase': exec('indent'); break;
        case 'format_indent_decrease': exec('outdent'); break;
        case 'superscript': exec('superscript'); break;
        case 'subscript': exec('subscript'); break;
        // Placeholders para funcionalidades que exigem implementação própria
        default:
          M.toast({html: 'Ação "' + cmd + '" por implementar'});
      }
    });

    // Controlo de fonte e tamanho
    document.getElementById('fontName').addEventListener('change', function(){
      exec('fontName', this.value);
    });
    document.getElementById('fontSize').addEventListener('change', function(){
      // Nota: execCommand fontSize aceita valores 1..7; mapeamento rápido
      const px = parseInt(this.value, 10);
      const map = px <= 10 ? 1 : px <= 12 ? 2 : px <= 16 ? 3 : px <= 18 ? 4 : px <= 24 ? 5 : px <= 32 ? 6 : 7;
      exec('fontSize', map);
    });

    // Nome do documento (apenas visual)
    document.getElementById('docName').addEventListener('input', function(){
      document.querySelector('.brand-logo').lastChild.textContent = ' ' + (this.value || 'Documento sem nome');
    });
  </script>
</body>
</html>

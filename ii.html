<!DOCTYPE html>
<html lang="pt">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Marca√ß√£o de Consultas</title>

  <!-- Materialize CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet">
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />

  <style>
    body {
      background: #e4e9f7;
      font-family: 'Roboto', sans-serif;
    }

    /* TOP BAR */
    .top-bar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 45px;
      background: #1976d2;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 15px;
      z-index: 1000;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.16);
    }

    .top-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .top-left img {
      height: 28px;
    }

    .online-dot {
      width: 10px;
      height: 10px;
      background: #4caf50;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* SIDEBAR CHAT */
    .chat-sidebar {
      position: fixed;
      top: 45px;
      left: 0;
      width: 380px;
      height: calc(100vh - 45px);
      background: #fff;
      z-index: 999;
      transform: translateX(-100%);
      transition: transform .3s ease;
      display: flex;
      flex-direction: column;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
    }

    .chat-sidebar.open {
      transform: translateX(0);
    }

    .chat-header {
      padding: 12px;
      background: #f5f5f5;
      border-bottom: 1px solid #ddd;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .chat-header h6 {
      margin: 0;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .chat-messages {
      flex: 1;
      padding: 15px;
      background: #fafafa;
      overflow-y: auto;
    }

    .chat-input {
      padding: 12px;
      background: #fff;
      border-top: 1px solid #ddd;
      display: flex;
      gap: 8px;
    }

    .chat-input input {
      flex: 1;
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }

    /* FLOAT BUTTON */
    .chat-fab {
      position: fixed;
      bottom: 20px;
      left: 20px;
      background: #1976d2;
      color: #fff;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, .3);
      cursor: pointer;
      z-index: 1001;
      transition: all .3s ease;
    }

    .chat-fab:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 16px rgba(0, 0, 0, .4);
    }

    /* MAIN */
    main {
      padding: 60px 20px 20px;
      transition: margin-left .3s ease;
      max-width: 1400px;
      margin-left: auto;
      margin-right: auto;
    }

    .chat-sidebar.open~main {
      margin-left: calc(380px + (100vw - 1400px) / 2);
    }

    @media (max-width: 1400px) {
      .chat-sidebar.open~main {
        margin-left: 380px;
      }
    }

    /* T√çTULO DA P√ÅGINA */
    .page-title {
      text-align: center;
      margin-bottom: 20px;
      color: #1976d2;
      font-weight: 500;
    }

    /* BOX */
    .box {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      margin-bottom: 20px;
    }

    .box h6 {
      margin: 0 0 15px 0;
      font-weight: 500;
      color: #1976d2;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* CHAT MESSAGE */
    .chat-message {
      margin-bottom: 12px;
      padding: 10px;
      border-radius: 8px;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .chat-message.user {
      background: #e3f2fd;
      text-align: right;
      margin-left: 40px;
    }

    .chat-message.system {
      background: #f5f5f5;
      margin-right: 40px;
    }

    /* CARD M√âDICO */
    .medico-card {
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
      transition: all 0.3s;
      cursor: pointer;
    }

    .medico-card:hover {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      transform: translateY(-2px);
    }

    .medico-card.selected {
      border: 2px solid #1976d2;
      background: #e3f2fd;
    }

    .medico-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .medico-avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: #1976d2;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      font-weight: bold;
    }

    .medico-details h6 {
      margin: 0;
      color: #333;
      font-size: 16px;
    }

    .medico-details p {
      margin: 5px 0 0 0;
      color: #666;
      font-size: 14px;
    }

    .badge-disponivel {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 500;
      background: #d4edda;
      color: #155724;
      margin-top: 5px;
    }

    .badge-ocupado {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 500;
      background: #f8d7da;
      color: #721c24;
      margin-top: 5px;
    }

    /* HOR√ÅRIOS */
    .horarios-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 10px;
      margin-top: 15px;
    }

    .horario-btn {
      padding: 10px;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      background: white;
      cursor: pointer;
      text-align: center;
      transition: all 0.3s;
    }

    .horario-btn:hover {
      background: #e3f2fd;
      border-color: #1976d2;
    }

    .horario-btn.selected {
      background: #1976d2;
      color: white;
      border-color: #1976d2;
    }

    .horario-btn.disabled {
      background: #f5f5f5;
      color: #999;
      cursor: not-allowed;
    }

    /* ALINHAMENTO DOS √çCONES */
    .btn i {
      vertical-align: middle;
      line-height: inherit;
      display: inline-flex;
      align-items: center;
    }

    /* VALIDA√á√ÉO */
    .input-field.error input,
    .input-field.error select {
      border-bottom: 1px solid #f44336 !important;
      box-shadow: 0 1px 0 0 #f44336 !important;
    }

    .error-message {
      color: #f44336;
      font-size: 12px;
      margin-top: 5px;
      display: none;
    }

    .error-message.show {
      display: block;
    }

    /* RESPONSIVO */
    @media (max-width: 992px) {
      .chat-sidebar {
        width: 100%;
      }

      .chat-sidebar.open~main {
        margin-left: 0;
      }
    }
  </style>

</head>

<body>

  <!-- TOP BAR -->
  <div class="top-bar">
    <div class="top-left">
      <img src="https://clipartcraft.com/images/best-logo-design-transparent-6.png" alt="Logo">
      <div>
        <div>Marca√ß√£o de Consultas</div>
        <small>Agende sua Consulta</small>
      </div>
    </div>
    <div style="display:flex;align-items:center;gap:10px;">
      <span>Sistema Online</span>
      <div class="online-dot"></div>
    </div>
  </div>

  <!-- CHAT BUTTON -->
  <div class="chat-fab" id="btnOpenChat">
    <i class='bx bx-chat bx-sm'></i>
  </div>

  <!-- CHAT SIDEBAR -->
  <div class="chat-sidebar" id="chatSidebar">
    <div class="chat-header">
      <h6><i class='bx bx-message-square-dots'></i> Assistente Virtual</h6>
      <a class="btn-flat" id="btnCloseChat"><i class='bx bx-x bx-sm'></i></a>
    </div>
    <div class="chat-messages" id="chatMessages">
      <div class="chat-message system">
        <strong>Assistente:</strong> Ol√°! Posso ajud√°-lo a agendar uma consulta. Qual especialidade voc√™ procura?
      </div>
    </div>
    <div class="chat-input">
      <input type="text" id="chatInput" placeholder="Digite sua mensagem...">
      <a class="btn blue" onclick="sendMsg()">
        <i class='bx bx-send'></i>
      </a>
    </div>
  </div>

  <!-- MAIN CONTENT -->
  <main id="mainContent">

    <!-- T√çTULO DA P√ÅGINA -->
    <h5 class="page-title">Marca√ß√£o de Consultas</h5>

    <!-- LAYOUT HORIZONTAL -->
    <div class="row">

      <!-- FORMUL√ÅRIO DE BUSCA (ESQUERDA - 50%) -->
      <div class="col s12 l6">
        <div class="box">
          <h6><i class='bx bx-search'></i> Buscar Especialidade</h6>
          
          <form id="formBusca">
            <div class="row">
              <div class="input-field col s12">
                <input type="text" id="nomePaciente" required>
                <label for="nomePaciente">Nome do Paciente *</label>
                <span class="error-message" id="errorNome">Campo obrigat√≥rio</span>
              </div>
            </div>

            <div class="row">
              <div class="input-field col s12 m6">
                <input type="tel" id="telefone" required>
                <label for="telefone">Telefone *</label>
                <span class="error-message" id="errorTelefone">Campo obrigat√≥rio</span>
              </div>
              <div class="input-field col s12 m6">
                <input type="email" id="email">
                <label for="email">E-mail</label>
              </div>
            </div>

            <div class="row">
              <div class="input-field col s12">
                <select id="especialidade" onchange="buscarMedicos()" required>
                  <option value="" disabled selected>Selecione a especialidade</option>
                  <option value="Cardiologia">Cardiologia</option>
                  <option value="Dermatologia">Dermatologia</option>
                  <option value="Ortopedia">Ortopedia</option>
                  <option value="Pediatria">Pediatria</option>
                  <option value="Ginecologia">Ginecologia</option>
                  <option value="Oftalmologia">Oftalmologia</option>
                  <option value="Psiquiatria">Psiquiatria</option>
                  <option value="Cl√≠nico Geral">Cl√≠nico Geral</option>
                </select>
                <label>Especialidade *</label>
                <span class="error-message" id="errorEspecialidade">Selecione uma especialidade</span>
              </div>
            </div>

            <div class="row">
              <div class="input-field col s12">
                <input type="date" id="dataConsulta" onchange="buscarMedicos()" required>
                <label for="dataConsulta">Data Desejada *</label>
                <span class="error-message" id="errorData">Campo obrigat√≥rio</span>
              </div>
            </div>

            <div class="row">
              <div class="col s12">
                <button type="button" class="btn blue" onclick="buscarMedicos()">
                  <i class='bx bx-search'></i> Buscar M√©dicos Dispon√≠veis
                </button>
              </div>
            </div>
          </form>
        </div>

        <!-- HOR√ÅRIOS DISPON√çVEIS -->
        <div class="box" id="boxHorarios" style="display: none;">
          <h6><i class='bx bx-time'></i> Hor√°rios Dispon√≠veis</h6>
          <div id="horariosDisponiveis"></div>
          
          <div class="row" style="margin-top: 20px;">
            <div class="col s12">
              <button type="button" class="btn green" onclick="confirmarConsulta()">
                <i class='bx bx-check-circle'></i> Confirmar Consulta
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- M√âDICOS DISPON√çVEIS (DIREITA - 50%) -->
      <div class="col s12 l6">
        <div class="box" style="min-height: 600px;">
          <h6><i class='bx bx-user-pin'></i> M√©dicos Dispon√≠veis</h6>
          
          <div id="listaMedicos" style="max-height: 700px; overflow-y: auto;">
            <p class="center-align" style="color: #999; padding: 40px;">
              Selecione uma especialidade e data para ver os m√©dicos dispon√≠veis
            </p>
          </div>
        </div>
      </div>

    </div>

  </main>

  <!-- Materialize JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

  <script>
    // Dados simulados
    const medicos = [
      {
        id: 1,
        nome: "Dr. Jo√£o Silva",
        especialidade: "Cardiologia",
        crm: "CRM 12345-SP",
        disponivel: true,
        horarios: ["08:00", "09:00", "10:00", "14:00", "15:00", "16:00"]
      },
      {
        id: 2,
        nome: "Dra. Maria Santos",
        especialidade: "Cardiologia",
        crm: "CRM 23456-SP",
        disponivel: true,
        horarios: ["09:00", "10:00", "11:00", "15:00", "16:00"]
      },
      {
        id: 3,
        nome: "Dr. Pedro Costa",
        especialidade: "Dermatologia",
        crm: "CRM 34567-SP",
        disponivel: true,
        horarios: ["08:00", "09:00", "13:00", "14:00", "15:00"]
      },
      {
        id: 4,
        nome: "Dra. Ana Oliveira",
        especialidade: "Dermatologia",
        crm: "CRM 45678-SP",
        disponivel: false,
        horarios: []
      },
      {
        id: 5,
        nome: "Dr. Carlos Mendes",
        especialidade: "Ortopedia",
        crm: "CRM 56789-SP",
        disponivel: true,
        horarios: ["08:00", "10:00", "14:00", "16:00"]
      },
      {
        id: 6,
        nome: "Dra. Beatriz Lima",
        especialidade: "Pediatria",
        crm: "CRM 67890-SP",
        disponivel: true,
        horarios: ["09:00", "10:00", "11:00", "14:00", "15:00", "16:00"]
      },
      {
        id: 7,
        nome: "Dra. Julia Ferreira",
        especialidade: "Ginecologia",
        crm: "CRM 78901-SP",
        disponivel: true,
        horarios: ["08:00", "09:00", "13:00", "14:00"]
      },
      {
        id: 8,
        nome: "Dr. Ricardo Alves",
        especialidade: "Oftalmologia",
        crm: "CRM 89012-SP",
        disponivel: true,
        horarios: ["10:00", "11:00", "14:00", "15:00", "16:00"]
      },
      {
        id: 9,
        nome: "Dra. Fernanda Rocha",
        especialidade: "Psiquiatria",
        crm: "CRM 90123-SP",
        disponivel: true,
        horarios: ["08:00", "09:00", "10:00", "13:00", "14:00"]
      },
      {
        id: 10,
        nome: "Dr. Lucas Martins",
        especialidade: "Cl√≠nico Geral",
        crm: "CRM 01234-SP",
        disponivel: true,
        horarios: ["08:00", "09:00", "10:00", "11:00", "14:00", "15:00", "16:00"]
      }
    ];

    let medicoSelecionado = null;
    let horarioSelecionado = null;

    // Inicializar Materialize
    document.addEventListener('DOMContentLoaded', function () {
      M.updateTextFields();
      M.FormSelect.init(document.querySelectorAll('select'));
      
      // Definir data m√≠nima como hoje
      const hoje = new Date().toISOString().split('T')[0];
      document.getElementById('dataConsulta').setAttribute('min', hoje);
    });

    // CHAT CONTROLS
    const chatSidebar = document.getElementById('chatSidebar');
    const btnOpen = document.getElementById('btnOpenChat');
    const btnClose = document.getElementById('btnCloseChat');

    btnOpen.onclick = () => {
      chatSidebar.classList.add('open');
      btnOpen.style.display = 'none';
    };

    btnClose.onclick = () => {
      chatSidebar.classList.remove('open');
      btnOpen.style.display = 'flex';
    };

    // CHAT
    function sendMsg() {
      const input = document.getElementById('chatInput');
      const mensagem = input.value.trim();

      if (!mensagem) {
        M.toast({ html: '‚ö†Ô∏è Digite uma mensagem', classes: 'orange' });
        return;
      }

      const chatMessages = document.getElementById('chatMessages');
      chatMessages.innerHTML += `
        <div class="chat-message user">
          <strong>Voc√™:</strong> ${mensagem}
        </div>
      `;

      input.value = '';
      chatMessages.scrollTop = chatMessages.scrollHeight;

      setTimeout(() => {
        chatMessages.innerHTML += `
          <div class="chat-message system">
            <strong>Assistente:</strong> Entendi. Estou aqui para ajudar com agendamento de consultas e informa√ß√µes sobre especialidades m√©dicas.
          </div>
        `;
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }, 1000);
    }

    document.getElementById('chatInput').addEventListener('keypress', function (e) {
      if (e.key === 'Enter') {
        sendMsg();
      }
    });

    // BUSCAR M√âDICOS
    function buscarMedicos() {
      const especialidade = document.getElementById('especialidade').value;
      const data = document.getElementById('dataConsulta').value;

      if (!especialidade || !data) {
        M.toast({ html: '‚ö†Ô∏è Selecione uma especialidade e data', classes: 'orange' });
        return;
      }

      const medicosDisponiveis = medicos.filter(m => m.especialidade === especialidade);
      const listaMedicos = document.getElementById('listaMedicos');

      if (medicosDisponiveis.length === 0) {
        listaMedicos.innerHTML = `
          <p class="center-align" style="color: #999; padding: 40px;">
            Nenhum m√©dico encontrado para esta especialidade
          </p>
        `;
        return;
      }

      listaMedicos.innerHTML = '';
      medicosDisponiveis.forEach(medico => {
        const iniciais = medico.nome.split(' ').map(n => n[0]).join('').substring(0, 2);
        const badgeClass = medico.disponivel ? 'badge-disponivel' : 'badge-ocupado';
        const badgeText = medico.disponivel ? '‚úì Dispon√≠vel' : '‚úó Ocupado';

        listaMedicos.innerHTML += `
          <div class="medico-card ${!medico.disponivel ? 'disabled' : ''}" 
               onclick="${medico.disponivel ? `selecionarMedico(${medico.id})` : ''}" 
               id="medico-${medico.id}">
            <div class="medico-info">
              <div class="medico-avatar">${iniciais}</div>
              <div class="medico-details">
                <h6>${medico.nome}</h6>
                <p>${medico.crm}</p>
                <span class="${badgeClass}">${badgeText}</span>
              </div>
            </div>
          </div>
        `;
      });

      M.toast({ html: `üìã ${medicosDisponiveis.length} m√©dico(s) encontrado(s)`, classes: 'blue' });
    }

    // SELECIONAR M√âDICO
    function selecionarMedico(id) {
      medicoSelecionado = medicos.find(m => m.id === id);
      
      // Remover sele√ß√£o anterior
      document.querySelectorAll('.medico-card').forEach(card => {
        card.classList.remove('selected');
      });

      // Adicionar sele√ß√£o
      document.getElementById(`medico-${id}`).classList.add('selected');

      // Mostrar hor√°rios
      mostrarHorarios();

      M.toast({ html: `‚úÖ M√©dico selecionado: ${medicoSelecionado.nome}`, classes: 'green' });
    }

    // MOSTRAR HOR√ÅRIOS
    function mostrarHorarios() {
      if (!medicoSelecionado) return;

      const boxHorarios = document.getElementById('boxHorarios');
      const horariosDiv = document.getElementById('horariosDisponiveis');

      boxHorarios.style.display = 'block';

      horariosDiv.innerHTML = '<div class="horarios-grid"></div>';
      const grid = horariosDiv.querySelector('.horarios-grid');

      medicoSelecionado.horarios.forEach(horario => {
        grid.innerHTML += `
          <div class="horario-btn" onclick="selecionarHorario('${horario}')">
            ${horario}
          </div>
        `;
      });
    }

    // SELECIONAR HOR√ÅRIO
    function selecionarHorario(horario) {
      horarioSelecionado = horario;

      document.querySelectorAll('.horario-btn').forEach(btn => {
        btn.classList.remove('selected');
      });

      event.target.classList.add('selected');

      M.toast({ html: `üïê Hor√°rio selecionado: ${horario}`, classes: 'blue' });
    }

    // CONFIRMAR CONSULTA
    function confirmarConsulta() {
      const nome = document.getElementById('nomePaciente').value.trim();
      const telefone = document.getElementById('telefone').value.trim();
      const data = document.getElementById('dataConsulta').value;

      if (!nome || !telefone || !medicoSelecionado || !horarioSelecionado) {
        M.toast({ html: '‚ö†Ô∏è Preencha todos os campos e selecione m√©dico e hor√°rio', classes: 'orange' });
        return;
      }

      const dataFormatada = new Date(data + 'T00:00:00').toLocaleDateString('pt-BR');

      M.toast({ 
        html: `‚úÖ Consulta confirmada!<br>
               ${medicoSelecionado.nome}<br>
               ${dataFormatada} √†s ${horarioSelecionado}`, 
        classes: 'green',
        displayLength: 6000
      });

      // Limpar formul√°rio
      setTimeout(() => {
        document.getElementById('formBusca').reset();
        document.getElementById('listaMedicos').innerHTML = `
          <p class="center-align" style="color: #999; padding: 40px;">
            Selecione uma especialidade e data para ver os m√©dicos dispon√≠veis
          </p>
        `;
        document.getElementById('boxHorarios').style.display = 'none';
        medicoSelecionado = null;
        horarioSelecionado = null;
        M.updateTextFields();
        M.FormSelect.init(document.querySelectorAll('select'));
      }, 2000);
    }
  </script>
  
</body>

</html>